<th:block xmlns:th="http://www.thymeleaf.org" >
    <ul style="list-style-type: none">
        <!--<ul class="nav navbar-nav navbar-right">
            <li class="nav-item" sec:authorize="isAnonymous()" xmlns:sec="http://www.w3.org/1999/xhtml">
                <a class="btn btn-light btn-sm ml-3" href="/login">
                    <i class="fa-solid fa-right-to-bracket"></i> Login
                </a>
            </li>
        </ul>-->
        <li class="nav-item">
            <a class="btn btn-light btn-sm ml-3" href="/logout">
                <i class="fa-solid fa-right-from-bracket"></i> Logout
            </a>
        </li>
    </ul>
    <br>
    <main>
        <h2>Search an event:</h2>
        <form th:method="GET" th:action="@{/events}">
            <label for="searchName">By Event Name:</label>
            <input id="searchName" type="text" th:value="${name}" name="name" placeholder="Search an event">
            <br/>
            <label for="locationSelect">By Location:</label>
            <select name="locationId" id="locationSelect">
                <option value="">All locations</option>
                <option th:each="loc : ${locations}"
                        th:value="${loc.getId()}"
                        th:text="${loc.getName()}"
                        th:selected="${locationId != null && locationId == loc.getId()}">
                </option>
            </select>

            <br/>
            <label for="minRating">By Minimum Event Rating (0 - 10): </label>
            <input id="minRating" type="number" name="minRating" min="0" max="10" placeholder="Min Rating">
            <br/>
            <input type="submit" value="Submit">
        </form>

        <div>
            <a href="/events/add-form" class="btn btn-dark">Add new event</a>
        </div>

        <form th:method="POST" th:action="@{/eventBookingController}">
            <h2>Choose an event:</h2>

            <div th:each="event : ${page.getContent()}">
                <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                    <input type="radio" name="rad" th:value="${event.name}" />
                    <strong th:text="${event.name}"></strong><br/>
                    Date: <span th:text="${#temporals.format(event.date, 'dd/MM/yyyy')}"></span><br/>
                    Description: <span th:text="${event.description}"></span><br/>
                    Rating: <span th:text="${event.popularityScore != null ? event.popularityScore : 1.0}"></span><br/>
                    Location: <span th:text="${event.location != null ? event.location.name : 'No location'}"></span><br/>

                    <th:block sec:authorize="hasRole('ROLE_ADMIN')">
                        <form th:action="@{'/events/delete/{id}' (id=${event.id})}" th:method="DELETE" style="display:inline;">
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </form>
                        <a th:href="@{'/events/edit-form/{id}' (id=${event.id})}" class="btn btn-info">Edit</a>
                    </th:block>
                </div>
            </div>

            <div th:include="fragments/paging :: pageSection(${page})"></div>

            <h2>Enter Reservation Name:</h2>
            <input type="text" name="hostName"><br/><br/>

            <h2>Choose number of tickets:</h2>
            <input type="number" name="numTickets" min="1" max="10"><br/><br/>

            <input type="submit" value="Submit" class="mb-5">
        </form>
    </main>
</th:block>
